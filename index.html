<!doctype html>
<html lang="en">
    <head>
        <!-- Recommended meta tags -->
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width,initial-scale=1.0">
        <!-- PyScript CSS -->
        <link rel="stylesheet" href="https://pyscript.net/releases/2025.11.2/core.css">
        <!-- This script tag bootstraps PyScript -->
        <script type="module" src="https://pyscript.net/releases/2025.11.2/core.js"></script>

        <title>Nickolas's Compiler</title>
    </head>
    <style>
body {font-family: Arial;}

/* Style the tab */
.tab {
  overflow: hidden;
  border: 1px solid #ccc;
  background-color: #f1f1f1;
}

/* Style the buttons inside the tab */
.tab button {
  background-color: inherit;
  float: left;
  border: none;
  outline: none;
  cursor: pointer;
  padding: 14px 16px;
  transition: 0.3s;
  font-size: 17px;
}

/* Change background color of buttons on hover */
.tab button:hover {
  background-color: #ddd;
}

/* Create an active/current tablink class */
.tab button.active {
  background-color: #ccc;
}

/* Style the tab content */
.tab_content {
  display: none;
  padding: 6px 12px;
  border: 1px solid #ccc;
  border-top: none;
}
</style>

    <body>
    <label for="program"></label>
        <div class="tab">
          <button class="tablinks" onclick="openTextBox(event, 'program')">program</button>
          <button class="tablinks" onclick="openTextBox(event, 'grammar')">grammar</button>
          <button class="tablinks" onclick="openTextBox(event, 'parse-tree')">parse-tree</button>
            <button class="tablinks" onclick="openTextBox(event, 'assembly')">assembly</button>
            <button class="tablinks" onclick="openTextBox(event, 'binary')">binary</button>
            <button class="tablinks" onclick="openTextBox(event, 'program-error')">program-error</button>
        </div>


        <!-- program text box -->
        <textarea id="program" class="tab_content" name="program" rows="5" cols="40" placeholder="Enter your program here">Loading...</textarea>

        <!-- grammar text box -->
        <textarea id="grammar" class="tab_content" name="grammar" rows="5" cols="40" readonly="readonly">Loading...</textarea>

        <!-- parse-tree text box -->
        <textarea id="parse-tree" class="tab_content" name="parse-tree" rows="5" cols="40" readonly="readonly">Loading...</textarea>

        <!-- assembly text box -->
        <textarea id="assembly" class="tab_content" name="assembly" rows="5" cols="40" readonly="readonly">Loading...</textarea>

        <!-- binary text box -->
        <textarea id="binary" class="tab_content" name="binary" rows="5" cols="40" readonly="readonly">Loading...</textarea>

        <!-- program error text box -->
        <textarea id="program-error" class="tab_content" name="program-error" rows="5" cols="40" readonly="readonly">Loading...</textarea>

    </body>
</html>

<script type="py" src="./web_interface.py" config="./pyscript.json"></script>

<script>
    function openTextBox(evt, name) {
         let i, tabcontent, tablinks;
         tabcontent = document.getElementsByClassName("tab_content");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
          tablinks = document.getElementsByClassName("tablinks");
          for (i = 0; i < tablinks.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" active", "");
          }
          document.getElementById(name).style.display = "block";
          evt.currentTarget.className += " active";
    }

</script>

 <script type="module">

     async function fetchFileContent(filePath) {
         try {
             const response = await fetch(filePath);

             if (!response.ok) {
                 // Handle cases where the file doesn't exist (404) or other errors
                 throw new Error(`HTTP error! status: ${response.status} - Could not find file at ${filePath}`);
             }

             // Get the file content as plain text
             return await response.text();

         } catch (error) {
             console.error("Error fetching file:", error);
             return `Failed to load file: ${error.message}`;
         }
     }

        const programFile = "/examples/example.txt";
        const grammarFile = "/grammar.txt"

        const program_text = await fetchFileContent(programFile);
        const grammar_text = await fetchFileContent(grammarFile);

        document.getElementById('program').value = program_text;
        document.getElementById('grammar').value = grammar_text;
    </script>